<mat-card class="employee-card mat-elevation-z4">

  <mat-toolbar class="employee-toolbar">
    <div class="toolbar-title">
      <mat-icon>group</mat-icon>
      <span class="title">Employees</span>
    </div>


    <div class="toolbar-actions">
      <div class="search-wrapper">
        <input class="search-input" type="text" placeholder="Search" [(ngModel)]="searchTerm"
          aria-label="Search employees" />
      </div>

      <button matButton="tonal" routerLink="add">
        <mat-icon>person_add</mat-icon>
        Add
      </button>
    </div>
  </mat-toolbar>

  <!-- Inline persistent error banner -->
  @if(errorMessage()){
  <div class="error-banner" role="alert">
    <mat-icon>error</mat-icon>
    <span class="error-text">{{ errorMessage() }}</span>
    <button mat-icon-button (click)="clearError()">
      <mat-icon>close</mat-icon>
    </button>
  </div>
  }

  <mat-card-content class="table-container">
    <div class="table-scroll">
      <table mat-table [dataSource]="filteredEmployees()" matSort (matSortChange)="onSortChange($event)"
        class="employee-table">

        <ng-container matColumnDef="id">
          <th mat-header-cell *matHeaderCellDef>ID</th>
          <td mat-cell *matCellDef="let emp">{{ emp.id }}</td>
        </ng-container>

        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef>Name</th>
          <td mat-cell class="text-ellipse" *matCellDef="let emp">{{ emp.name }}</td>
        </ng-container>

        <ng-container matColumnDef="department">
          <th mat-header-cell *matHeaderCellDef>Department</th>
          <td mat-cell *matCellDef="let emp">{{ emp.department }}</td>
        </ng-container>

        <ng-container matColumnDef="salary">
          <th [ngClass]="{'hide-mat-sort-icon': sortDirection() === ''}" mat-header-cell *matHeaderCellDef
            mat-sort-header>Salary
            @if(sortDirection() === ''){<mat-icon class="default-sort-icon">swap_vert</mat-icon>}
          </th>
          <td mat-cell *matCellDef="let emp">{{ emp.salary | currency:'INR' }}</td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef class="actions-header">Actions</th>
          <td mat-cell *matCellDef="let emp" class="actions-cell">
            <button mat-icon-button color="primary" [routerLink]="'edit/'+emp.id">
              <mat-icon class="text-primary-container">edit</mat-icon>
            </button>
            <button mat-icon-button color="warn" (click)="openDeleteDialog(emp.id)">
              <mat-icon class="text-error-container">delete</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns" class="header-row"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

      </table>

      @if(showLoading()){
      <div class="loading-spinner">
        <mat-progress-spinner diameter="35" mode="indeterminate"></mat-progress-spinner>
      </div>
      }

      @if(!showLoading() && filteredEmployees().length === 0){
      <div class="no-data">
        No employees data available.
      </div>
      }
    </div>
  </mat-card-content>

</mat-card>